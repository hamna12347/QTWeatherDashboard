<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather App Tables</title>

    <style> 

body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(to bottom right, #d9e5ff, #a7c6ed);
            transition: background 0.5s, color 0.5s;
        }

.container {
            display: flex;
            height: 100vh;
        }

.sidebar {
    width: 300px;
    background-color: #09022b; 
    color: white;
    padding: 25px;
    height: 100vh;
    box-shadow: 5px 0 15px rgba(0, 0, 0, 0.3);
}

.sidebar h7 {
    font-size: 28px; 
    
    font-style: bold;
    margin: 0;
    padding: 0;

}

.sidebar a {
    font-size: 18px;
    padding: 18px;
    margin-top: 30px;
    margin-bottom: 10px;
    background-color: #3F92BB; 
    border-radius: 10px;
    text-align: center;
    display: block;
    color: white;
    text-decoration: none;
    position: relative;
    transition: 0.3s ease;
}

.sidebar a:hover {
    background-color: #2c82a0; 
    box-shadow: 0 0 10px rgba(63, 146, 187, 0.8); 
}

.sidebar a::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(255, 255, 255, 0.1);
    transition: transform 0.5s ease;
    transform: scale(0);
    border-radius: 10px; /* Match button border radius */
}

.sidebar a:hover::after {
    transform: scale(1);
}

.menu a {
    display: block;
    padding: 18px;
    margin-bottom: -9px;
    background-color: #3F92BB; /* Softer button color */
    border-radius: 10px;
    text-align: center;
    color: white;
    text-decoration: none;
    transition: 0.3s ease;
    box-shadow: 0 0 15px rgba(107, 160, 201, 0.5); /* Button glow effect */
}

.menu a:hover {
    background-color: #5491b3; /* Hover color */
    box-shadow: 0 0 20px rgba(107, 160, 201, 1); /* Stronger glow on hover */
}

.main-content {
    flex: 1;
    padding: 20px;
}

.weather-section {
    background-color: #9fb9f3; /* Soft blue for weather section */
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
    margin-bottom: 20px;
}

.weather-section h2 {
    margin-bottom: 20px;
    font-size: 22px;
}

.current-weather {
    background-color: #d2e7f3; /* Lighter blue for current weather */
    padding: 15px;
    border-radius: 8px;
    box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
    text-align: center;
}

.chat-section {
    width: 35%;
}

.chat-bar {
    padding: 20px;
    background-color: #a7c6ed; /* Lighter color for chat bar */
    border: none;
    margin-bottom: 20px;
    display: flex;
    border-radius: 10px;
    box-shadow: 0 0 15px rgba(107, 160, 201, 0.5);
}

.chat-bar input {
    flex: 1;
    padding: 10px;
    border-radius: 5px;
    margin-right: 10px;
}

.chat-bar button {
    padding: 10px;
    background-color: #6ba0c9; /* Softer button color */
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: 0.3s;
}

.chat-bar button:hover {
    background-color: #5491b3; /* Darker button on hover */
}

.pagination button {
    margin: 0 5px;
    padding: 10px 20px; /* Increased padding for larger buttons */
    border: none;
    border-radius: 8px; /* Rounded corners */
    background-color: #6ba0c9; /* Button color */
    color: white;
    cursor: pointer;
    transition: background-color 0.3s, transform 0.2s; /* Smooth transition */
    font-size: 16px; /* Larger font size */
}

.pagination button:hover {
    background-color: #5491b3; /* Darker button on hover */
    transform: scale(1.05); /* Slightly enlarge on hover */
}


table {
    width: 100%;
    border-collapse: collapse; /* Ensures borders are combined */
    margin-bottom: 20px;
    border-radius: 15px; /* Round corners */
    overflow: hidden; /* Prevents overflow of border radius */
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); /* Softer shadow effect */
}

th, td {
    border: 1px solid #ddd; /* Softer border color */
    padding: 12px; /* More padding for a softer feel */
    text-align: center;
    background-color: #f9f9f9; /* Soft background for cells */
    transition: background-color 0.3s; /* Smooth background transition */
}

th {
    background-color: #4a92b2; /* Header background color */
    color: white; /* Header text color */
}

tr:hover td {
    background-color: #e0f7fa; /* Highlight row on hover */
}


.pagination {
    display: flex;
    justify-content: center;
    margin-top: 10px;
}



.search-bar {
    padding: 12px;
    width: 300px;
    margin-top: 20px;
    margin-bottom: 30px;
    border-radius: 10px; /* Softer corners */
    border: 2px solid #4a92b2; /* Softer border color */
    box-shadow: 0 0 10px rgba(74, 146, 178, 0.5); /* Glow effect */
    outline: none; /* Remove default outline */
    transition: background-color 0.3s, box-shadow 0.3s; /* Smooth transition */
    background-color: #d2e7f3; /* Soft background color */
    font-size: 16px; /* Font size */
}

.search-bar::placeholder {
    color: #6ba0c9; /* Placeholder color */
    opacity: 0.7; /* Slightly faded for visibility */
}

.search-bar:focus {
    background-color: #a7c6ed; /* Slightly darker when focused */
    box-shadow: 0 0 15px rgba(107, 160, 201, 1); /* Stronger glow on focus */
}

















.chat-header {
    text-align: left;
    margin-left: 30px;
    margin-top: 40px;
    margin-bottom: 15px; /* Space between header and chat area */
}

.chat-header h2 {
    font-size: 24px; /* Size of the bot's name */
    color: #2c3e50; /* Text color */
    margin-bottom: -10px; /* Space between name and prompt */
}

.chat-header p {
    font-size: 16px; /* Size of the prompt */
    color: #041f21; /* Lighter color for the prompt */
}

.chat-answer {
    background-color: #ffffff; /* Background color for the message box */
    border-radius: 15px; /* Rounded corners */
    padding: 15px; /* Padding inside the box */
    margin: 10px 0; /* Space between messages */
    box-shadow: 0 0 15px rgba(63, 146, 187, 0.5); /* Glowing effect */
    position: relative; /* Position for pseudo-element */
    transition: 0.3s; /* Smooth transition for hover effect */
}

.chat-answer:hover {
    box-shadow: 0 0 25px rgba(63, 146, 187, 1); /* Stronger glow on hover */
}

.chat-answer p {  
    color: #2c3e50; /* Text color for the response */
    font-size: 16px; /* Font size */
    font-family: Verdana, Geneva, Tahoma, sans-serif;
    line-height: 1.5; /* Line height for readability */

}

.user-message {
    background-color: #7da6db; 
    color: white; 
    border-radius: 15px; 
    padding: 15px; 
    margin: 10px 0; 
    box-shadow: 0 0 15px rgba(125, 166, 219, 0.5); 
}




















.filters {
    margin-bottom: 20px;
    margin-top: 30px;
    display: flex;
    gap: 15px;
    justify-content: center;
}

.filters select {
    padding: 12px;
    border-radius: 25px;
    border: none;
    background-color: rgba(255, 255, 255, 0.8);
    color: #2c3e50;
    font-size: 16px;
    box-shadow: 0 4px 10px rgba(63, 146, 187, 0.5);
    transition: background-color 0.3s, transform 0.2s;
}

.filters select:hover, .filters select:focus {
    background-color: rgba(255, 255, 255, 0.95);
    outline: none;
    box-shadow: 0 8px 15px rgba(63, 146, 187, 1);
}

.filters button {
    padding: 12px 20px;
    border: none;
    border-radius: 25px;
    background-color: #3F92BB;
    color: white;
    font-size: 16px;
    cursor: pointer;
    box-shadow: 0 4px 10px rgba(63, 146, 187, 0.5);
    transition: all 0.3s ease;
}

.filters button:hover {
    background-color: #2c82a0;
    transform: translateY(-3px);
    box-shadow: 0 8px 15px rgba(63, 146, 187, 0.8);
}

.filters button:focus {
    outline: none;
    box-shadow: 0 0 15px rgba(63, 146, 187, 1);
}

/* For small screens (mobile) */
@media only screen and (max-width: 600px) {
    .container {
        flex-direction: column;
        height: auto;
    }

    .sidebar {
        width: 100%;
        height: auto;
        text-align: center;
    }

    .sidebar h7 {
        font-size: 24px;
    }

    .sidebar a {
        font-size: 16px;
        padding: 12px;
        margin: 10px 0;
    }

    .main-content {
        padding: 10px;
    }

    .weather-section {
        padding: 10px;
        margin-bottom: 10px;
    }

    .current-weather {
        padding: 10px;
    }

    table {
        font-size: 14px;
    }

    .pagination button {
        padding: 8px 12px;
        font-size: 14px;
    }

    .search-bar {
        width: 100%;
        padding: 10px;
    }
}

/* For tablets */
@media only screen and (min-width: 601px) and (max-width: 1024px) {
    .container {
        flex-direction: column;
    }

    .sidebar {
        width: 100%;
        height: auto;
        text-align: center;
    }

    .sidebar a {
        font-size: 18px;
        padding: 14px;
        margin: 10px 0;
    }

    .main-content {
        padding: 15px;
    }

    .weather-section {
        padding: 15px;
    }

    .current-weather {
        padding: 12px;
    }

    table {
        font-size: 16px;
    }

    .pagination button {
        padding: 10px 16px;
        font-size: 15px;
    }

    .search-bar {
        width: 90%;
        padding: 12px;
    }

    .chat-section {
        width: 100%;
    }
}

/* For larger screens (desktop) */
@media only screen and (min-width: 1025px) {
    .container {
        flex-direction: row;
    }

    .sidebar {
        width: 300px;
    }

    .main-content {
        flex: 1;
        padding: 20px;
    }

    .weather-section {
        padding: 20px;
    }

    .current-weather {
        padding: 15px;
    }

    table {
        font-size: 18px;
    }

    .pagination button {
        padding: 12px 20px;
        font-size: 16px;
    }

    .search-bar {
        width: 300px;
    }
}



</style>    
</head>
<body>
    <div class="container">
        <nav class="sidebar">
            <h1><strong>Weather App</strong></h1>
            <div class="menu">
                <a href="dashboard.html">Dashboard</a>
                <a href="tables.html">Tables</a>
            </div>
        </nav>

        <main class="main-content">
            <div class="top-bar">
                <input type="text" class="search-bar" id="searchCity" placeholder="Search city..." aria-label="City search" />
                <div class="user-profile"></div>
            </div>

            <div class="tables-section">
                <div class="table" id="weatherTable">
                    <h2>Temperature Forecast</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Date & Time</th>
                                <th>Temperature (°C)</th>
                                <th>Condition</th>
                            </tr>
                        </thead>
                        <tbody id="weatherData">
                            <!-- Weather data will be inserted here -->
                        </tbody>
                    </table>
                    <div class="pagination">
                        <button id="prevPage" disabled>Previous</button>
                        <button id="nextPage">Next</button>
                    </div>
                </div>
            </div>

            <div class="filters">
                <select id="filterOptions">
                    <option value="default" selected>Choose Filter</option>
                    <option value="asc">Sort by Temp (Ascending)</option>
                    <option value="desc">Sort by Temp (Descending)</option>
                    <option value="rain">Show Days with Rain</option>
                    <option value="highest">Show Highest Temperature</option>
                    <option value="reset">Reset</option>
                </select>
                <button id="applyFilter">Apply</button>
            </div>




            
            <div class="chat-header">
                <h2>qtbot</h2>
                <p>Ask me anything</p>
            </div>
            <div class="chat-section">
                <div class="chat-bar">
                    <input type="text" id="userInput" placeholder="Ask a question..." aria-label="User question input" />
                    <button id="sendChat">Send</button>
                </div>
                <div class="chat-answer" id="chatAnswer">
                    <!-- Chatbot answers will be displayed here -->
                </div>
            </div>
        </main>
    </div>
</body>





    <script>
        const apiKey = 'b8c044a6d8defa038dafd4cb46f23219'; // Your OpenWeather API key
        const geminiApiKey = 'AIzaSyDrDPa1jC2OidEmupbupOAM9_ACciuF7yE'; // Your Gemini API key
        const weatherDataContainer = document.getElementById('weatherData');
        const prevPageButton = document.getElementById('prevPage');
        const nextPageButton = document.getElementById('nextPage');
        const chatAnswer = document.getElementById('chatAnswer'); // Assuming you have this element in your HTML
        const userInput = document.getElementById('userInput'); // Input for user queries
        const searchCityInput = document.getElementById('searchCity'); // Input for city search
        
        let currentCity = 'London'; // Default city
        let currentPage = 0; // Current pagination page
        const entriesPerPage = 10; // Number of entries to show per page
        let forecastData = []; // Store forecast data
        
        // Function to fetch weather data based on city search
        function getWeather(city) {
            const apiUrl = `https://api.openweathermap.org/data/2.5/weather?q=${city}&units=metric&appid=${apiKey}`;
        
            fetch(apiUrl)
                .then(response => response.json())
                .then(data => {
                    if (data.cod === 200) { // Check if the city was found
                        currentCity = city; // Update current city
                        fetchForecast(city); // Fetch forecast data after current weather
                    } else {
                        alert('City not found. Please try again.'); // Alert if city is not found
                    }
                })
                .catch(error => {
                    console.error('Error fetching weather data:', error);
                });
        }
        
        // Function to fetch forecast data for the next 10 days
        function fetchForecast(city) {
            const apiUrl = `https://api.openweathermap.org/data/2.5/forecast?q=${city}&units=metric&cnt=40&appid=${apiKey}`; // Fetch 40 entries
        
            fetch(apiUrl)
                .then(response => response.json())
                .then(data => {
                    if (data.cod === "200") { // Check if the forecast was found
                        forecastData = []; // Reset forecast data
                        const forecastList = data.list;
        
                        // Extract data for the next 40 entries (every 3 hours)
                        for (let i = 0; i < Math.min(forecastList.length, 40); i++) {
                            forecastData.push({
                                datetime: new Date(forecastList[i].dt * 1000).toLocaleString(), // Format date and time
                                temp: forecastList[i].main.temp,
                                condition: forecastList[i].weather[0].main
                            });
                        }
        
                        currentPage = 0; // Reset to the first page when fetching new data
                        updateTable(); // Update the table with the first page of data
                    } else {
                        alert('Error fetching forecast data. Please try again.'); // Alert if fetching fails
                    }
                })
                .catch(error => {
                    console.error('Error fetching forecast data:', error);
                });
        }
        
        // Function to update the weather table
        function updateTable() {
            weatherDataContainer.innerHTML = ''; // Clear previous data
            const start = currentPage * entriesPerPage; // Calculate start index
            const end = start + entriesPerPage; // Calculate end index
        
            const paginatedData = forecastData.slice(start, end); // Slice data for current page
        
            paginatedData.forEach(entry => {
                weatherDataContainer.innerHTML += `
                    <tr>
                        <td>${entry.datetime}</td>
                        <td>${entry.temp}°C</td>
                        <td>${entry.condition}</td>
                    </tr>
                `;
            });
        
            // Update pagination buttons
            prevPageButton.disabled = currentPage === 0; // Disable if on first page
            nextPageButton.disabled = end >= forecastData.length; // Disable if on last page
        }
        
        // Event listeners for pagination buttons
        nextPageButton.addEventListener('click', () => {
            if ((currentPage + 1) * entriesPerPage < forecastData.length) {
                currentPage++;
                updateTable();
            }
        });
        
        prevPageButton.addEventListener('click', () => {
            if (currentPage > 0) {
                currentPage--;
                updateTable();
            }
        });
        
        // Event listener for the search input
        searchCityInput.addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                const city = this.value;
                getWeather(city); // Fetch weather data for the searched city
                currentPage = 0; // Reset page to 0 on new search
            }
        });
        
        getWeather('London'); // Initial fetch for London
        
        // Fetch response from Gemini API using user input
        async function fetchGeminiAnswer(userInput) {
            const apiKey = geminiApiKey; // Assuming geminiApiKey is globally defined
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${apiKey}`;
    
            if (!userInput || userInput.trim() === '') {
                return "Error: Input is empty.";
            }
    
            // Prepare the request body with only the user's input message
            const requestBody = {
                contents: [
                    {
                        parts: [
                            {
                                text: userInput // Sending the user's message directly
                            }
                        ]
                    }
                ]
            };
    
            try {
                console.log("Request Body:", JSON.stringify(requestBody));
    
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestBody)
                });
    
                console.log(`Response Status: ${response.status}`);
    
                if (!response.ok) {
                    const errorDetails = await response.json(); // Capture more error details
                    console.error('Gemini API Error:', errorDetails);
                    throw new Error(`Gemini API Error: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log("Full Response from API: ", data);
    
                if (data?.candidates?.length > 0) {
                    const generatedContent = data?.candidates?.[0]?.content?.parts?.[0]?.text || "No response found in expected format";
                    return generatedContent;
                } else {
                    throw new Error('Received no candidates from Gemini.');
                }
            } catch (error) {
                console.error('Gemini API Error:', error);
                return "There was an error generating content";
            }
        }
    
        // Chatbot integration
        async function chatWithGemini(userQuery) {
            // Check if the query is about the weather
            if (userQuery.toLowerCase().includes('weather')) {
                const highestTemp = Math.max(...forecastData.map(entry => entry.temp));
                const lowestTemp = Math.min(...forecastData.map(entry => entry.temp));
                const avgTemp = forecastData.reduce((acc, entry) => acc + entry.temp, 0) / forecastData.length;
                const city = currentCity; // Get the current city
    
                // Create the response HTML
                const response = `
                    <div class="chat-answer">
                        <p>The highest temperature this week in <strong>${city}</strong> is <strong>${highestTemp}°C</strong>, the lowest is <strong>${lowestTemp}°C</strong>, and the average is <strong>${avgTemp.toFixed(2)}°C</strong>.</p>
                    </div>
                `;
    
                // Display response in chat area
                chatAnswer.innerHTML = response;
            } else {
                // Call Gemini API for non-weather queries
                const geminiResponse = await fetchGeminiAnswer(userQuery);
                chatAnswer.innerHTML = geminiResponse; // Display response
            }
        }
    
        // Event listener for sending chat messages
        document.getElementById('sendChat').addEventListener('click', async function () {
            const query = userInput.value;
            if (query) {
                await chatWithGemini(query); // Handle user query
                userInput.value = ''; // Clear input
            }
        });
    </script>
    




</body>

</html>
